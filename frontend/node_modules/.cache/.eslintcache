[{"/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/index.js":"1","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/App.js":"2","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/SignInForm.js":"3","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/ChatInterface.js":"4","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/useToken.js":"5","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/RegisterForm.js":"6","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/useUser.js":"7","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/TopicButton.js":"8"},{"size":251,"mtime":1649140882110,"results":"9","hashOfConfig":"10"},{"size":1182,"mtime":1649140882024,"results":"11","hashOfConfig":"10"},{"size":3701,"mtime":1651382653509,"results":"12","hashOfConfig":"10"},{"size":10305,"mtime":1652072758664,"results":"13","hashOfConfig":"10"},{"size":523,"mtime":1649140882085,"results":"14","hashOfConfig":"10"},{"size":4855,"mtime":1649491390701,"results":"15","hashOfConfig":"10"},{"size":548,"mtime":1649140882109,"results":"16","hashOfConfig":"10"},{"size":1540,"mtime":1652074756485,"results":"17","hashOfConfig":"10"},{"filePath":"18","messages":"19","suppressedMessages":"20","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"vy6rpv",{"filePath":"21","messages":"22","suppressedMessages":"23","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"24"},{"filePath":"25","messages":"26","suppressedMessages":"27","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"28"},{"filePath":"29","messages":"30","suppressedMessages":"31","errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"32"},{"filePath":"33","messages":"34","suppressedMessages":"35","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"36","messages":"37","suppressedMessages":"38","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"39","messages":"40","suppressedMessages":"41","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"42","messages":"43","suppressedMessages":"44","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/index.js",[],[],"/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/App.js",["45"],[],"import \"./App.css\";\nimport ChatInterface from \"./Components/ChatInterface\";\nimport SignInForm from \"./Components/SignInForm\";\nimport RegisterForm from \"./Components/RegisterForm\";\nimport useToken from \"./Components/useToken\";\nimport { BrowserRouter as Router, Route, Routes } from \"react-router-dom\";\nimport useUser from \"./Components/useUser\";\n\nfunction App() {\n  const { token, setToken } = useToken();\n  const { signedInUser, setSignedInUser } = useUser();\n\n  return (\n    <div>\n      <Router>\n        <Routes>\n          {!token && token !== \"\" && token !== undefined ? (\n            <>\n              <Route path=\"/\" element={<SignInForm />} />\n              <Route path=\"/register\" element={<RegisterForm />} />\n              <Route path=\"/chat\" element={<SignInForm />} />\n            </>\n          ) : (\n            <>\n              <Route\n                path=\"/chat\"\n                setToken={setToken}\n                setSignedInUser={setSignedInUser}\n                element={<ChatInterface />}\n              />\n              <Route path=\"/\" element={<SignInForm />} />\n            </>\n          )}\n        </Routes>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/SignInForm.js",["46"],[],"import React from \"react\";\nimport \"./SignInForm.css\";\nimport { Button } from \"react-bootstrap\";\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport chatIcon from \"../img/chat-app-icon.png\";\nimport userIcon from \"../img/userIcon.png\";\nimport pwdIcon from \"../img/passwordIcon.png\";\nimport { useNavigate } from \"react-router-dom\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faEye, faEyeSlash } from \"@fortawesome/free-solid-svg-icons\";\nimport io from \"socket.io-client\";\n\nconst SignInForm = () => {\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [passwordShown, setPasswordShown] = useState(false);\n  const [wrongDetails, setWrongDetails] = useState(false);\n\n  let navigate = useNavigate();\n\n  const togglePasswordVisibility = () => {\n    setPasswordShown(!passwordShown);\n  };\n\n  const socket = io.connect();\n\n\n  const handleClick = () => {\n    const data = {\n      username: username,\n      password: password,\n    };\n\n    axios\n      .post(\"/api/token\", data, {\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n        },\n      })\n      .then((res) => {\n        console.log(res);\n        return res;\n      })\n      .then((res) => {\n        localStorage.setItem(\"token\", res.data.access_token);\n        localStorage.setItem(\"user\", username);\n        socket.emit(\"activateUser\", {username: username})\n        navigate(\"/chat\");\n        window.location.reload();\n      })\n      .catch((error) => {\n        console.log(\"There was an error!\", error);\n        setWrongDetails(true);\n      });\n  };\n\n  return (\n    <div className=\"wrapper\">\n      <div className=\"text-center pa-3\">\n        <img src={chatIcon} className=\"chatIcon\" alt=\"chat-icon\"></img>\n      </div>\n      <div className=\"text-center mt4 name\">Sign in to ChatSpace</div>\n      {wrongDetails ? (\n        <p className=\"text-center mt-4 wrongDetails\">\n          Please enter a valid username and/or password\n        </p>\n      ) : (\n        \"\"\n      )}\n      <form className=\"p-3 mt-3 text-center\">\n        <div className=\"form-field d-flex align-items-center\">\n          {\" \"}\n          <span>\n            {\" \"}\n            <img className=\"userIcon\" alt=\"userIcon\" src={userIcon} />{\" \"}\n          </span>{\" \"}\n          <input\n            type=\"text\"\n            name=\"userName\"\n            id=\"userName\"\n            placeholder=\"Username\"\n            onChange={(e) => setUsername(e.target.value)}\n            value={username}\n          ></input>\n        </div>\n        <div className=\"form-field d-flex align-items-center\">\n          {\" \"}\n          <span>\n            <img className=\"pwdIcon\" alt=\"pwdIcon\" src={pwdIcon} />\n          </span>{\" \"}\n          <input\n            type={passwordShown ? \"text\" : \"password\"}\n            name=\"password\"\n            id=\"password\"\n            placeholder=\"Password\"\n            onChange={(e) => setPassword(e.target.value)}\n            onKeyUp={(e) => {\n              if (e.key === \"Enter\") {\n                handleClick();\n              }\n            }}\n            value={password}\n          ></input>\n          <span className=\"passwordEyeIcon\">\n            <FontAwesomeIcon\n              icon={passwordShown ? faEye : faEyeSlash}\n              onClick={togglePasswordVisibility}\n            />\n          </span>\n        </div>\n        <Button className=\"btn mt-3 p-2 loginBtn\" onClick={handleClick}>\n          Login\n        </Button>\n      </form>\n\n      <div className=\"text-center fs-6 p-3\">\n        {\" \"}\n        Not a member? <a href=\"/register\">Sign Up</a>\n      </div>\n    </div>\n  );\n};\n\nexport default SignInForm;\n","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/ChatInterface.js",["47","48","49","50","51","52","53","54"],[],"import React, { useEffect, useState } from \"react\";\nimport { Button } from \"react-bootstrap\";\nimport \"./ChatInterface.css\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport useToken from \"./useToken\";\nimport useUser from \"./useUser\";\nimport io from \"socket.io-client\";\nimport { DateTime } from \"luxon\";\nimport TopicButton  from \"./TopicButton\"\n\nconst ChatInterface = () => {\n  window.setTimeout(function () {\n    let element = document.getElementById(\"chatBox\");\n    element.scrollTop = element.scrollHeight;\n  });\n\n  const [currentTopic, setCurrentTopic] = useState(\"General\");\n\n  const [messages, setMessages] = useState([]);\n\n  const [users, setUsers] = useState([]);\n\n  const { removeToken } = useToken();\n\n  const { signedInUser, signOutUser } = useUser();\n\n  const [activeUsers, setActiveUsers] = useState([]);\n\n  const [message, setMessage] = useState(\"\");\n\n  // const [newMessage, setNewMessage] = useState(\"\")\n\n  const [clearMessage, setClearMessage] = useState(false)\n\nconst [newMessage, setNewMessage] = useState( {\n          General: false,\n          Art: false,\n          \"Film & TV\": false,\n          Music: false,\n          Sports: false,\n})\n       \n\n\n  let navigate = useNavigate();\n\n  const getUserInfo = (user_id) => {\n    return users.find((user) => user.id === user_id);\n  };\n\n  const selectSignedInUser = (signedInUser) => {\n    let theUserId;\n    users.find((user) => {\n      if (user.username === signedInUser) {\n        theUserId = user.id;\n      }\n    });\n    return theUserId;\n  };\n\n  async function getMessages() {\n    await axios.get(`api/messages/${currentTopic}`).then((res) => {\n      setMessages(res.data);\n    });\n  }\n\n  async function getUsers() {\n    await axios.get(\"api/users\").then((res) => {\n      setUsers(res.data);\n    });\n  }\n\n  async function getActiveUsers() {\n    await axios.get(\"api/activeusers\").then((res) => {\n      setActiveUsers(res.data);\n    });\n  }\n\n  const actives = activeUsers?.map((user) => {\n    return (\n      <table className=\"d-flex text-center justify-content-center align-items-center pb-2\">\n        <td\n          style={\n            user?.username === signedInUser\n              ? { color: \"#ffa861\", fontWeight: \"bold\" }\n              : { color: \"#bafad4\" }\n          }\n        >\n          {user?.username === signedInUser\n            ? user?.username + \" (You)\"\n            : user?.username}\n        </td>\n        <br></br>\n      </table>\n    );\n  });\n\n  const data = messages?.map((message) => {\n    return {\n      ...message,\n      user: getUserInfo(message?.userid),\n    };\n  });\n\n  let userId = selectSignedInUser(signedInUser);\n\n  function dateSuffix(day) {\n    if (day % 10 === 1) return `${day}st`;\n    if (day % 10 === 2) return `${day}nd`;\n    if (day % 10 === 3) return `${day}rd`;\n    return `${day}th`;\n  }\n\n  const convertDate = (date) => {\n    const weekday = DateTime.fromISO(date).toFormat(\"EEEE\");\n    const year = DateTime.fromISO(date).toFormat(\"yyyy\");\n    const day = dateSuffix(DateTime.fromISO(date).toFormat(\"d\"));\n    const month = DateTime.fromISO(date).toFormat(\"MMMM\");\n\n    return `${weekday}, ${month} ${day}, ${year}`;\n  };\n\n  const databaseSend = () => {\n    let messageBox = document.getElementById(\"messageBox\");\n\n    if (message !== \"\") {\n      socket.emit(\"new_message\", {\n        userId: userId,\n        text: message,\n        topic: currentTopic,\n      });\n      \n    }\n    setMessage(\"\");\n    messageBox.value = \"\";\n\n  };\n  \n\n  const logOut = () => {\n    axios\n      .post(\"/api/logout\", data, {\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n        },\n      })\n      .then((res) => {\n        removeToken();\n        socket.emit(\"deactivateUser\", { username: signedInUser });\n        signOutUser();\n        navigate(\"/\");\n        window.location.reload();\n      })\n      .catch((error) => {\n        console.log(\"An error was caught!\", error);\n      });\n\n    // const user = {\n    //   username: signedInUser,\n    // };\n\n    // axios\n    //   .post(\"api/deactivateuser\", user, {\n    //     headers: {\n    //       Accept: \"application/json\",\n    //       \"Content-Type\": \"application/json\",\n    //     },\n    //   })\n    //   .then((res) => {\n    //     console.log(res);\n    //     return res;\n    //   })\n    //   .catch((error) => {\n    //     console.log(\"There was an error!\", error);\n    //   });\n  };\n\n  useEffect(() => {\n    getMessages();\n    getUsers();\n    getActiveUsers();\n    console.log(currentTopic)\n  }, [currentTopic]);\n\n  const socket = io.connect();\n\n  useEffect(() => {\n    if (newMessage === currentTopic ) {\n      console.log(newMessage)\n      // setNewMessage(\"\")\n      // setClearMessage(true)\n      \n    } \n    // checkClearedMessage()\n    \n    console.log(newMessage)\n    // console.log(clearMessage)\n\n  }, [newMessage])\n\n  // useEffect(() => {\n  //   checkClearedMessage()\n  //   console.log(clearMessage)\n    \n  // }, [clearMessage])\n\n  // const checkClearedMessage = () => {\n  //   if (clearMessage === true + newMessage) {\n  //     setNewMessage(\"\")\n  //     console.log(clearMessage)\n  //     setClearMessage(false)\n  //     console.log(newMessage)\n  //   }\n  //   console.log(clearMessage)\n  // }\n\n  useEffect(() => {\n\n    let newSocket = io.connect()\n    socket.on(\"connect\", () => {\n      // console.log(\"Connected...\")\n    });\n    newSocket.on(\"new_message\", (message) => {\n   \n        setMessages((messages) => [...messages, message[0]]);\n        if (message[0].topic != currentTopic) {\n\n          console.log(\"topic doesn't match...\")\n          console.log(currentTopic)\n\n        }\n        setNewMessage( {\n\n          ...newMessage,\n          [message[0].topic]: true\n        })\n          \n        \n       console.log(message[0])\n       \n        \n      });\n      \n\n    socket.on(\"activateUser\", () => {\n      getActiveUsers();\n    });\n\n    socket.on(\"deactivateUser\", () => {\n      getActiveUsers();\n    });\n  }, []);\n\n  // const clearNewMessage = () => {\n  //   setNewMessage(\"\")\n  //   console.log(newMessage)\n    \n  // }\n\n  const formatTime = (utcTime) => {\n    const time = DateTime.fromISO(utcTime).toFormat(\"t\");\n    return time;\n  };\n\n  const filteredData = data.filter((message) => {\n    if (message.topic === currentTopic) {\n      return message\n\n    }\n  })\n\n\n\n  const theMessages =\n    filteredData &&\n    filteredData.map((message, index) => {\n      let prev = data[index - 1];\n      let current = data[index];\n\n      return (\n        <div>\n          {prev?.createddate === current?.createddate ? (\n            \"\"\n          ) : (\n            <div>\n              <div className=\"fw-bold mx-auto horizontalLine\"></div>\n              <div className=\"fw-bold mt-4\" style={{ color: \"#444c55\" }}>\n                {convertDate(message?.createddate)}\n              </div>\n            </div>\n          )}\n\n          <div\n            className=\"chat-container\"\n            style={\n              message.user?.username === signedInUser\n                ? { background: \"#e45437\" }\n                : { background: \"\" }\n            }\n            key={index}\n          >\n            <div\n              className=\"card-header d-flex justify-content-between p-3\"\n              style={{ borderBottom: \"1px solid rgba(255, 255, 255, 0.3\" }}\n            >\n              <p className=\"fw-bold mb-0 paddingRight\">\n                {message?.user?.username}\n              </p>\n              <p className=\" small mb-0\">\n                <i>{formatTime(message?.time_created)}</i>\n              </p>\n            </div>\n            <div className=\"card-body\">\n              <p className=\"mb-0 mx-auto p-2\">{message.text}</p>\n            </div>\n          </div>\n        </div>\n      );\n    });\n\n  return (\n    <>\n      <div id=\"container\">\n        <div className=\"text-center mx-auto\" id=\"navbar\">\n          {currentTopic}\n        </div>\n\n        <div className=\"userBox col-3 userText\">\n          <h6 className=\"text-center p-3 mt-2 pb-1\">Active Users</h6>\n          <p className=\"text-center\">{actives}</p>\n\n          <h6 className=\"text-center p-3\">Topics</h6>\n\n          <TopicButton topicName={\"General\"} currentTopic={currentTopic} setCurrentTopic={setCurrentTopic} newMessage={newMessage.General} setNewMessage={setNewMessage} />\n          <TopicButton topicName={\"Art\"} currentTopic={currentTopic} setCurrentTopic={setCurrentTopic} newMessage={newMessage.Art} setNewMessage={setNewMessage} />\n          <TopicButton topicName={\"Film & TV\"} currentTopic={currentTopic} setCurrentTopic={setCurrentTopic} newMessage={newMessage[\"Film & TV\"]} setNewMessage={setNewMessage} />\n          <TopicButton topicName={\"Music\"} currentTopic={currentTopic} setCurrentTopic={setCurrentTopic} newMessage={newMessage.Music} setNewMessage={setNewMessage} />\n          <TopicButton topicName={\"Sports\"} currentTopic={currentTopic} setCurrentTopic={setCurrentTopic} newMessage={newMessage.Sports} setNewMessage={setNewMessage} />\n\n          \n\n          <Button\n            className=\"p-2 d-flex justify-content-center align-items-center mx-auto mb-4 logoutBtn\"\n            onClick={logOut}\n          >\n            Logout\n          </Button>\n        </div>\n\n        <div className=\"parent\">\n          <div className=\"discussionBox\" id=\"chatBox\">\n            {theMessages}\n        \n          </div>\n\n          <div className=\"flex child\">\n            <div>\n              <div className=\"input-group\">\n                <textarea\n                  id=\"messageBox\"\n                  type=\"text\"\n                  className=\"form-control messageBox\"\n                  rows=\"2\"\n                  cols=\"500\"\n                  onChange={(e) => {\n                    setMessage(e.target.value);\n                  }}\n                  value={message}\n                  placeholder=\"Type Your Message\"\n                  onKeyUp={(e) => {\n                    if (e.key === \"Enter\") {\n                      databaseSend();\n                    \n                    }\n                  }}\n                />\n              </div>\n            </div>\n            <Button\n              type=\"submit\"\n              className=\"btn sendBtn\"\n              onClick={databaseSend}\n            >\n              SEND\n            </Button>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default ChatInterface;\n","/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/useToken.js",[],[],"/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/RegisterForm.js",[],[],"/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/useUser.js",[],[],"/Users/crystalword/Documents/Coding/Portfolio Projects/chat_app/frontend/src/Components/TopicButton.js",[],[],{"ruleId":"55","severity":1,"message":"56","line":11,"column":11,"nodeType":"57","messageId":"58","endLine":11,"endColumn":23},{"ruleId":"55","severity":1,"message":"59","line":4,"column":20,"nodeType":"57","messageId":"58","endLine":4,"endColumn":29},{"ruleId":"55","severity":1,"message":"60","line":34,"column":10,"nodeType":"57","messageId":"58","endLine":34,"endColumn":22},{"ruleId":"55","severity":1,"message":"61","line":34,"column":24,"nodeType":"57","messageId":"58","endLine":34,"endColumn":39},{"ruleId":"62","severity":1,"message":"63","line":54,"column":23,"nodeType":"64","messageId":"65","endLine":54,"endColumn":25},{"ruleId":"66","severity":1,"message":"67","line":185,"column":6,"nodeType":"68","endLine":185,"endColumn":20,"suggestions":"69"},{"ruleId":"66","severity":1,"message":"70","line":201,"column":6,"nodeType":"68","endLine":201,"endColumn":18,"suggestions":"71"},{"ruleId":"72","severity":1,"message":"73","line":228,"column":30,"nodeType":"74","messageId":"75","endLine":228,"endColumn":32},{"ruleId":"66","severity":1,"message":"76","line":254,"column":6,"nodeType":"68","endLine":254,"endColumn":8,"suggestions":"77"},{"ruleId":"62","severity":1,"message":"78","line":267,"column":46,"nodeType":"64","messageId":"79","endLine":267,"endColumn":48},"no-unused-vars","'signedInUser' is assigned a value but never used.","Identifier","unusedVar","'useEffect' is defined but never used.","'clearMessage' is assigned a value but never used.","'setClearMessage' is assigned a value but never used.","array-callback-return","Array.prototype.find() expects a return value from arrow function.","ArrowFunctionExpression","expectedInside","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'getMessages'. Either include it or remove the dependency array.","ArrayExpression",["80"],"React Hook useEffect has a missing dependency: 'currentTopic'. Either include it or remove the dependency array.",["81"],"eqeqeq","Expected '!==' and instead saw '!='.","BinaryExpression","unexpected","React Hook useEffect has missing dependencies: 'currentTopic', 'newMessage', and 'socket'. Either include them or remove the dependency array. You can also do a functional update 'setNewMessage(n => ...)' if you only need 'newMessage' in the 'setNewMessage' call.",["82"],"Array.prototype.filter() expects a value to be returned at the end of arrow function.","expectedAtEnd",{"desc":"83","fix":"84"},{"desc":"85","fix":"86"},{"desc":"87","fix":"88"},"Update the dependencies array to be: [currentTopic, getMessages]",{"range":"89","text":"90"},"Update the dependencies array to be: [currentTopic, newMessage]",{"range":"91","text":"92"},"Update the dependencies array to be: [currentTopic, newMessage, socket]",{"range":"93","text":"94"},[4517,4531],"[currentTopic, getMessages]",[4830,4842],"[currentTopic, newMessage]",[5947,5949],"[currentTopic, newMessage, socket]"]